# Notion API Configuration
NOTION_API_KEY=your_notion_api_key_here

# DATA_SOURCE_ID is the primary variable for Notion API v5 (version 2025-09-03)
# This is the ID of the "data source" in Notion's new API architecture
# Run the discovery script to find the correct value for your database:
#   bun scripts/migration/discoverDataSource.ts
DATA_SOURCE_ID=your_data_source_id_here

# DATABASE_ID is kept for backward compatibility during migration
# In Notion API v5, DATABASE_ID and DATA_SOURCE_ID may be DIFFERENT values
# The DATABASE_ID fallback will be deprecated in a future release
DATABASE_ID=your_database_id_here

# Docusaurus Configuration
# Default landing page for docs redirect (e.g., 'introduction', 'introduction-remove', 'getting-started')
DEFAULT_DOCS_PAGE=introduction-remove

# Image Processing Configuration (PR #102)
# Enable/disable intelligent retry logic for handling Notion's 1-hour URL expiration
# When enabled: Automatically retries image downloads with progress validation
# When disabled: Falls back to single-pass processing (pre-PR #102 behavior)
# Valid values: "true" or "false" (case-insensitive)
# Default: "true"
ENABLE_RETRY_IMAGE_PROCESSING=true

# Maximum number of retry attempts per page when S3 URLs are detected in markdown
# Each retry re-processes the page to attempt image downloads again
# Valid values: 1-10 (integer as string)
# Default: "3"
# Recommendation: 3 attempts is optimal balance between recovery and performance
MAX_IMAGE_RETRIES=3

# Test Environment Configuration
# For translation workflow testing, you can use a dedicated test database
# When TEST_DATABASE_ID or TEST_DATA_SOURCE_ID is set, translation scripts
# will use the test database instead of the production database
#
# To enable test mode:
# 1. Set TEST_DATABASE_ID or TEST_DATA_SOURCE_ID to your test database ID
# 2. Optionally set TEST_MODE=true to explicitly enable test mode
#
# In test mode:
# - All translation operations use the test database
# - GitHub workflow dispatch validates target_branch against safe patterns
# - Safe branches: "test/*", "fix/*", "feat/*", or branches with "test" in name
# - Production branches ("main", "master", "content") are rejected in test mode
#
# Example:
# TEST_DATA_SOURCE_ID=test-database-id-here
# TEST_MODE=true

# OpenAI Configuration (Required for translation jobs)
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4o-mini

# API Server Configuration (for Docker deployment)
NODE_ENV=production
API_HOST=0.0.0.0
API_PORT=3001

# Content Repository Configuration (required for mutating jobs in API server)
# Required for: notion:fetch, notion:fetch-all, notion:translate
# GitHub repository URL must be HTTPS (no embedded credentials)
GITHUB_REPO_URL=https://github.com/digidem/comapeo-docs.git
# GitHub token with permissions to push to the content branch
GITHUB_TOKEN=your_github_token_here
# Git author identity used for content commits created by jobs
GIT_AUTHOR_NAME=CoMapeo Content Bot
GIT_AUTHOR_EMAIL=content-bot@example.com

# Content repository behavior (optional)
GITHUB_CONTENT_BRANCH=content
WORKDIR=/workspace/repo
COMMIT_MESSAGE_PREFIX=content-bot:
ALLOW_EMPTY_COMMITS=false

# API Authentication (Optional - generate secure keys with: openssl rand -base64 32)
# API_KEY_DEPLOYMENT=your_secure_api_key_here
# API_KEY_GITHUB_ACTIONS=your_github_actions_key_here
